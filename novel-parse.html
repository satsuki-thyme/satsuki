<html class="h">
<meta charset="utf-8">
<title>小説をパースするやつ</title>
<style>
/*

  一般的な設定

*/
html,
body {
  margin: 0;
  padding: 0;
}
h1 {
  margin-top: 0;
  margin-left: 0;
  font-size: 40px;
  font-weight: bold;
}
h2 {
  margin-top: 50px;
  margin-left: 15px;
  font-size: 30px;
  font-weight: bold;
}
h3 {
  margin-top: 40px;
  margin-left: 30px;
  font-size: 20px;
  font-weight: bold;
}
h4 {
  margin-top: 30px;
  margin-left: 45px;
  font-size: 20px;
  font-weight: bold;
}
h5 {
  margin-top: 20px;
  margin-left: 60px;
  font-size: 20px;
  font-weight: normal;
}
h6 {
  margin-top: 10px;
  margin-left: 75px;
  font-size: 20px;
  font-weight: normal;
}
h1 ~ p,
h1 ~ ol,
h1 ~ ul,
h1 ~ dl {
  margin-left: 10px;
}
h2 ~ p,
h2 ~ ol,
h2 ~ ul,
h2 ~ dl {
  margin-left: 25px;
}
h3 ~ p,
h3 ~ ol,
h3 ~ ul,
h3 ~ dl {
  margin-left: 40px;
}
h4 ~ p,
h4 ~ ol,
h4 ~ ul,
h4 ~ dl {
  margin-left: 65px;
}
h5 ~ p,
h5 ~ ol,
h5 ~ ul,
h5 ~ dl {
  margin-left: 80px;
}
h6 ~ p,
h6 ~ ol,
h6 ~ ul,
h6 ~ dl {
  margin-left: 15px;
}
label {
  display: block;
}
dt {
  display: inline-block;
}
dd + dt,
label + label {
  margin-top: 15px;
}
code {
  font-family: Arial, Helvetica, sans-serif;
}
/*

  このページ固有の設定

*/
html.v,
html.v body {
  height: 100%
}
html.v #frame {
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  width: 600px;
  height: 700px;
  max-height: 95%;
  margin: auto;
  overflow-x: auto;
}
html.v #text {
  width: unset;
  margin: 0;
  padding: 0 35px;
  letter-spacing: 0.07em;
  writing-mode: vertical-rl;
  text-orientation: upright;
}
body {
  color: #333;
  background-color: #fff;
}
div {
  margin: 0;
}
#text {
  width: 600px;
  max-width: 95%;
  margin: auto;
  padding: 50px 0 400px 0;
  font-family: "メイリオ", "Meiryo", 'Lucida Grande', "sans-serif";
  font-size: 16px;
  line-height: 28.8px;
}
#text.loaded p {
  margin: 0;
  padding: 0;
}
#text.loaded h1 + p {
  margin-top: 80px;
}
#left-chip {
  position: fixed;
  top: 0;
  left: 0;
}
#count-full,
#count-select {
  padding: 8px;
  float: left;
  line-height: 1em;
  background-color: #ccc;
}
#pickup-list li + li {
  margin-top: 30px;
}
.link-chip {
  position: relative;
  right: 0;
  text-align: right;
}
.link-chip:last-of-type {
  padding-bottom: 20px;
}
.link-chip a {
  display: inline-block;
  padding: 10px 5px 0 5px;
}
#mode-chip label {
  display: inline-block;
  margin-top: 0;
}
#mode-chip label + label {
  margin-left: 10px;
}
a,
a:visited,
a:hover {
  color: #62a433;
}
html.post #left-chip,
html.post .link-chip,
#count-full.unloaded,
#count-select.unselected,
#format-chip.unloaded,
#mode-chip.unloaded {
  display: none;
}
.prev + .next {
  margin-left: 5px;
}
#input {
  display: none;
}
#input-button {
  display: inline-block;
  margin: 0 3px;
  padding: 3px;
  line-height: 1;
  border-width: 1px;
  border-style: solid;
}
@media (prefers-color-scheme: dark) {
  body {
    background-color: #000;
  }
  body,
  #format-selector,
  #mode-chip {
    color: #ccc;
  }
  #count-full,
  #count-select,
  #format-selector,
  #mode-chip {
    background-color: #222;
  }
  #input-button {
    background-color: #444;
    border-top-color: #888;
    border-left-color: #888;
    border-right-color: #222;
    border-bottom-color: #222;
  }
}
html.light body {
  background-color: #fff;
}
html.light body,
html.light #format-selecotr,
html.light #mode-chip {
  color: #333;
}
html.light #count-full,
html.light #count-select,
html.light #format-selector,
html.light #mode-chip {
  background-color: #ccc;
}
html.dark body {
  background-color: #000;
}
html.dark body,
html.dark #format-selector,
html.dark #mode-chip {
  color: #ccc;
}
html.dark #count-full,
html.dark #count-select,
html.dark #format-selector,
html.dark #mode-chip {
  background-color: #222;
}
html.light #input-button {
  background-color: #aaa;
  border-top-color: #ccc;
  border-left-color: #ccc;
  border-right-color: #666;
  border-bottom-color: #666;
}
html.dark #input-button {
  background-color: #333;
  border-top-color: #666;
  border-left-color: #666;
  border-right-color: #222;
  border-bottom-color: #222;
}
</style>
<body>
<div class="link-chip">
  <a class="prev"></a>
  <a class="next"></a>
</div>
<div id="frame">
  <main id="text">
    <h1>使い方</h1>
    <p>表示するテキストファイルを<label id="input-button">ここ<input type="file" id="input"></label>から読み込むか、ドラッグ & ドロップしてください。</p>
    <h2>全文の文字数</h2>
    <p>表示される文字数は以下の文字を含みません。</p>
    <ul>
      <li>全角スペース</li>
      <li>半角スペース</li>
      <li>タブ</li>
      <li>改行記号</li>
      <li>ルビ</li>
    </ul>
    <h2>選択範囲の文字数</h2>
    <p>表示される文字数は以下の文字を含みません。ルビは数えられます。</p>
    <ul>
      <li>全角スペース</li>
      <li>半角スペース</li>
      <li>タブ</li>
      <li>改行記号</li>
    </ul>
    <h2>オプション</h2>
    <h3>フォーマット</h3>
    <dl>
      <label>
        <input id="format-reading" type="radio" name="format" value="reading" checked>
        <dt>閲覧</dt>
        <dd>閲覧用の表示でデフォルトです。</dd>
      </label>
      <label>
        <input id="format-post" type="radio" name="format" value="post">
        <dt>投稿</dt>
        <dd>Markdown が非表示になりますが面倒なのでテキトーです。ネット小説記法のルビをそのまま表示し、上付け文字に解釈することしません。</dd>
      </label>
      <label>
        <input id="format-plot" type="radio" name="format" value="plot">
        <dt>プロット</dt>
        <dd>プロットを確認する際の表示です。閲覧、投稿では表示されない記号などがそのまま表示されます。</dd>
      </label>
      <label>
        <input id="format-pickup" type="radio" name="format" value="pickup">
        <dt>ピックアップ</dt>
        <dd><span class="bracket"></span> で囲った部分をピックアップして表示します。</dd>
      </label>
      <label>
        <input id="format-odt" type="radio" name="format" value="odt">
        <dt>ODT</dt>
        <dd>ネット小説記法のルビを解釈し、 odt に変換してダウンロードします。 LibreOffice などで開くことができます。ダウンロードに際してブラウザから危険性を示唆されます。自己責任でご利用ください。</dd>
      </label>
    </dl>
    <h3>書き方向</h3>
    <p>横書きと縦書きが選べます。<br>
      フォーマット「 ODT 」には影響がありません。</p>
    <dl>
      <label>
        <input id="orient-h" type="radio" name="orient" value="orient-h" checked>
        <dt>横書き</dt>
        <dd>横書きです。</dd>
      </label>
      <label>
        <input id="orient-v" type="radio" name="orient" value="orient-v">
        <dt>縦書き</dt>
        <dd>縦書きです。</dd>
      </label>
    </dl>
    <h3>テーマ</h3>
    <p>テーマはブラウザの設定から自動的に選ばれますが、明示的に指定することも可能です。</p>
    <dl>
      <label>
        <input id="theme-light" type="radio" name="theme" value="light">
        <dt>ライト</dt>
        <dd>明るい配色です。</dd>
      </label>
      <label>
        <input id="theme-dark" type="radio" name="theme" value="dark">
        <dt>ダーク</dt>
        <dd>暗い配色です。</dd>
      </label>
    </dl>
    <h3>モード</h3>
    <p>原文の改行をそのまま反映するか、 2 個で 1 行の改行をするか選択できます。</p>
    <dl>
      <label>
        <input id="mode-normal" type="radio" name="mode" value="normal">
        <dt>標準</dt>
        <dd>原文の改行をそのまま反映します。</dd>
      </label>
      <label>
        <input id="mode-half" type="radio" name="mode" value="half">
        <dt>ハーフ</dt>
        <dd>原文の改行をそのまま反映します。</dd>
      </label>
    </dl>
    <h2>URL オプション</h2>
    <p>URL で ? に続けてオプションを指定することができます。</p>
    <p>& でつなげて複数指定することができます。</p>
    <p>例：<code>novel-parse?format=plot&theme=light&mode=c</code></p>
    <h3>フォーマット</h3>
    <dl>
      <dt>format=reading</dt>
      <dd>閲覧</dd>
      <dt>format=plot</dt>
      <dd>Markdown で書かれたプロットを特別な表示にする</dd>
      <dt>format=post</dt>
      <dd>投稿</dd>
      <dt>format=odt</dt>
      <dd>ODT</dd>
      <dt>format=pickup</dt>
      <dd><span class="bracket"></span> で囲った部分をピックアップして表示する</dd>
    </dl>
    <h3>テーマ</h3>
    <dl>
      <dt>theme=light</dt>
      <dd>ライト</dd>
      <dt>theme=dark</dt>
      <dd>ダーク</dd>
    </dl>
    <h3>モード</h3>
    <dl>
      <dt>mode=normal</dt>
      <dd>原文の改行をそのまま反映</dd>
      <dt>mode=half</dt>
      <dd>原文の改行 2 個で 1 行の改行</dd>
    </dl>
  </main><!-- text -->
</div><!-- frame -->
<div id="left-chip">
  <div id="count-chip">
    <div id="count-full" class="unloaded"></div>
    <div id="count-select" class="unselected"></div>
  </div>
  <div id="format-chip" class="unloaded">
    <select id="format-selector">
      <option value="reading">閲覧</option>
      <option value="post">投稿</option>
      <option value="plot">プロット</option>
      <option value="pickup">ピックアップ</option>
      <option value="odt">ODT</option>
    </select>
  </div>
  <div id="mode-chip" class="unloaded">
    <label>normal<input id="mode-chip-normal" type="radio" name="mode-chip" value="normal"></label>
    <label>half<input id="mode-chip-half" type="radio" name="mode-chip" value="half"></label>
  </div>
</div>
<div class="link-chip">
  <a class="prev"></a>
  <a class="next"></a>
</div>
</body>
<script src="https://etc.satsuki.me/mdparse.js"></script>
<script src="https://etc.satsuki.me/3rd-party-lib/jszip.min.js"></script>
<script src="https://etc.satsuki.me/3rd-party-lib/FileSaver.min.js"></script>
<script>
/*

  変数

*/
// URL の search の処理
let currOrigin = location.origin
let arr_search = location.search.slice(1).split("&")
let obj_search = {
  "format": "reading",
  "orient": "h",
  "theme": "auto",
  "mode": "normal"
}
arr_search.forEach(function(mediator) {
  let w = mediator.split("=")
  obj_search[w[0]] = w[1]
})
// DOM
let elm_title = document.querySelector("title")
let elm_input = document.querySelector("#input")
let elm_formatReading = document.querySelector("#format-reading")
let elm_formatPost = document.querySelector("#format-post")
let elm_formatPlot = document.querySelector("#format-plot")
let elm_formatPickup = document.querySelector("#format-pickup")
let elm_formatOdt = document.querySelector("#format-odt")
let elm_orientH = document.querySelector("#orient-h")
let elm_orientV = document.querySelector("#orient-v")
let elm_themeLight = document.querySelector("#theme-light")
let elm_themeDark = document.querySelector("#theme-dark")
let elm_html = document.querySelector("html")
let elm_frame = document.querySelector("#frame")
let elm_text = document.querySelector("#text")
let elm_countFull = document.querySelector("#count-full")
let elm_countSelect = document.querySelector("#count-select")
let elm_prev = document.querySelectorAll(".prev")
let elm_next = document.querySelectorAll(".next")
let elmArr_bracket = document.querySelectorAll(".bracket")
let elm_formatChip = document.querySelector("#format-chip")
let elm_formatSelector = document.querySelector("#format-selector")
let elm_modeChip = document.querySelector("#mode-chip")
let elm_modeNormal = document.querySelector("#mode-normal")
let elm_modeHalf = document.querySelector("#mode-half")
let elm_modeChipNormal = document.querySelector("#mode-chip-normal")
let elm_modeChipHalf = document.querySelector("#mode-chip-half")
// 改行の種類
let EOS = "\n"
// モード = 同一行の処理と、改行の読み取り
let obj_mode = {
  "normal": function(src) {
    return src.replace(/\r?\n/g, EOS)
              .replace(/(\r?\n){5,}(?<![^\r\n])/g, "")
  },
  "half": function(src) {
    return src.replace(/(.+)\r?\n/g, "$1")
              .replace(/(\r?\n){5,}(?<![^\r\n])/g, "")
              .replace(/\r?\n/g, EOS)
  }
}
// タイトル
let title = ""
// FileReader による読み込みファイル
let trgFile = null
// URL の search で作品が指定されていた場合の作品のホスト
let now = Date.now()
let arr_repoFile = []
let prevFile = ""
let nextFile = ""
if (obj_search["op"] !== undefined) {
  arr_repoFile = obj_search["op"].split("/")
  prevFile = arr_repoFile[1].replace(/(\[\d+\]).+/, "$1") + ("00" + (Number(arr_repoFile[1].replace(/\[\d+\](\d+)\..+/, "$1")) - 1)).slice(-3) + arr_repoFile[1].replace(/\[\d+\]\d+(\..+)/, "$1")
  nextFile = arr_repoFile[1].replace(/(\[\d+\]).+/, "$1") + ("00" + (Number(arr_repoFile[1].replace(/\[\d+\](\d+)\..+/, "$1")) + 1)).slice(-3) + arr_repoFile[1].replace(/\[\d+\]\d+(\..+)/, "$1")
}
let obj_url = {
  "http://etc.satsuki.c": {
    "backhost": "http://etc.satsuki.c/novel/" + arr_repoFile[0] + "/",
    "content":  "http://etc.satsuki.c/novel/" + obj_search["op"] + "?" + now,
    "readme":   "http://etc.satsuki.c/novel/" + arr_repoFile[0] + "/README.md?" + now,
    "linkBase": "http://etc.satsuki.c/novel-parse.html?op=" + arr_repoFile[0] + "/",
    "prev":     "http://etc.satsuki.c/novel-parse.html?op=" + arr_repoFile[0] + "/" + prevFile + "&format=" + obj_search["format"] + "&orient=" + obj_search["orient"] + "&theme=" + obj_search["theme"] + "&mode=" +  obj_search["mode"],
    "next":     "http://etc.satsuki.c/novel-parse.html?op=" + arr_repoFile[0] + "/" + nextFile + "&format=" + obj_search["format"] + "&orient=" + obj_search["orient"] + "&theme=" + obj_search["theme"] + "&mode=" +  obj_search["mode"]
  },
  "https://etc.satsuki.me": {
    "backhost": "https://raw.githubusercontent.com/satsuki-thyme/" + arr_repoFile[0] + "/master/",
    "content":  "https://raw.githubusercontent.com/satsuki-thyme/" + arr_repoFile[0] + "/master/" + arr_repoFile[1] + "?" + now,
    "readme":   "https://raw.githubusercontent.com/satsuki-thyme/" + arr_repoFile[0] + "/master/README.md?" + now,
    "linkBase": "https://etc.satsuki.me/novel-parse.html?op=" + arr_repoFile[0] + "/",
    "prev":     "https://etc.satsuki.me/novel-parse.html?op=" + arr_repoFile[0] + "/" + prevFile + "&format=" + obj_search["format"] + "&orient=" + obj_search["orient"] + "&theme=" + obj_search["theme"] + "&mode=" +  obj_search["mode"],
    "next":     "https://etc.satsuki.me/novel-parse.html?op=" + arr_repoFile[0] + "/" + nextFile + "&format=" + obj_search["format"] + "&orient=" + obj_search["orient"] + "&theme=" + obj_search["theme"] + "&mode=" +  obj_search["mode"]
  },
  "https://satsuki.me": {
    "backhost": "https://raw.githubusercontent.com/satsuki-thyme/" + arr_repoFile[0] + "/master/",
    "content":  "https://raw.githubusercontent.com/satsuki-thyme/" + arr_repoFile[0] + "/master/" + arr_repoFile[1] + "?" + now,
    "readme":   "https://raw.githubusercontent.com/satsuki-thyme/" + arr_repoFile[0] + "/master/README.md?" + now,
    "linkBase": "https://satsuki.me/novel-parse.html?op=" + arr_repoFile[0] + "/",
    "prev":     "https://satsuki.me/novel-parse.html?op=" + arr_repoFile[0] + "/" + prevFile + "&format=" + obj_search["format"] + "&orient=" + obj_search["orient"] + "&theme=" + obj_search["theme"] + "&mode=" +  obj_search["mode"],
    "next":     "https://satsuki.me/novel-parse.html?op=" + arr_repoFile[0] + "/" + nextFile + "&format=" + obj_search["format"] + "&orient=" + obj_search["orient"] + "&theme=" + obj_search["theme"] + "&mode=" +  obj_search["mode"]
  }
}
// タグの定義（タグ自身を処理の対象にする）
let arr_bracketItself = [
  {
    "before": "{",
    "after": "}",
    "replaceBefore": '<span style="color: #77f">',
    "replaceAfter": '</span>'
  }
]
// タグの定義（タグと中身を処理の対象にする）
let arr_bracketInclude = [
  {
    "before": "＜",
    "after": "＞",
    "replaceBefore": '<span style="color: #d00">',
    "replaceAfter": '</span>'
  }
]
// 目次
let arr_toc = []
// 変換先フォーマット毎の処理
let obj_format = {
  reading: function(src) {
    countFull(src)
    writeText(
      titleAdd(
        parseNewline(
          obj_mode[obj_search["mode"]](
            removeMd(
              parseRuby(
                procBracket(src))))
                  .replace(/# (.*)/, '<h1>$1</h1>'))))
  },
  post: function(src) {
    writeText(
      parseNewline(
        obj_mode[obj_search["mode"]](
          removeMd(
            procBracket(src))))
              .replace(/# (.*)/, '<h1>$1</h1>'))
  },
  plot: function(src) {
    countFull(src)
    writeText(
      titleAdd(
        parseNewline(
          obj_mode[obj_search["mode"]](
            removeMd(
              parseRuby(
                procBracket(src, 1))))
                  .replace(/# (.*)/, '<h1>$1</h1>'))))
  },
  pickup: function(src) {
    let monoLine = removeMd(src).replace(/\r?\n/g, "")
    let h = 0
    pick("")
    function pick(w0) {
      let w = w0
      let RE_w = RegExp(".{0,30}" + arr_bracketItself[h]["before"] + ".*?" + arr_bracketItself[h]["after"] + ".{0,30}" + "(.{0,30}" + arr_bracketItself[h]["after"] + ")?", "g")
      let match = monoLine.match(RE_w)
      if (match) {
        w += parseRuby(procBracket(match.join(EOS).replace(/^(.*)$/gm, '<li>$1</li>'), 1))
      }
      h++
      if (h < arr_bracketItself) {
        pick(w)
      } else {
        writeText(w.replace(/((.*(\r?\n)?)+)/gm, '<ul id="pickup-list">$1</ul>'))
      }
    }
  },
  odt: function(src) {
    let zip = new JSZip()
    let folder = null
    zip.file("content.xml", parseOdt(obj_mode[obj_search["mode"]](removeMd(procBracket(src)))))
    for (let i = 0; i < obj_odt["files"].length; i++) {
      let odtFileName = obj_odt["files"][i][0]
      let odtDirName = obj_odt["files"][i][1]
      let odtContent = obj_odt["files"][i][2]
      if (odtDirName === "/") {
        zip.file(odtFileName, odtContent)
      } else {
        folder = zip.folder(odtDirName)
        folder.file(odtFileName, odtContent)
      }
    }
    zip.generateAsync({type: "blob"}).then(function(content) {
      if (obj_search["op"] !== undefined) {
        saveAs(content, obj_makeFileName(search["op"]))
      } else {
        saveAs(content, makeFileName(trgFile.name))
      }
    })
    function makeFileName(src) {
      let w0 = src.split("/")
      let w1 = w0[w0.length - 1].split(".")
      let w2 = ""
      for (let i = 0; i < w1.length - 1; i++) {
          w2 += w1[i] + "."
      }
      return w2 + "odt"
    }
  },
  readme: function(src) {
    let fullLength = 0
    let toc = ""
    let h = 0
    arr_toc = makeToc(src)
    writeReadme(toc)
    function writeReadme() {
      loadContent(obj_url[currOrigin]["backhost"] + arr_toc[h][0])
      .then(m0 => {
        let partLength = removeRuby(removeMd(m0)).replace(/[\s　]/g, "").length
        fullLength += partLength
        return "* [" + arr_toc[h][1] + "](" + obj_url[currOrigin]["linkBase"] + arr_toc[h][0] + "&format=" + obj_search["format"] + "&theme=" + obj_search["theme"] + "&mode=" +  obj_search["mode"] + ") : " + partLength + "文字" + EOS
      })
      .then((m1) => {
        toc += m1
        h++
        if (h < arr_toc.length) {
          writeReadme(toc)
        } else {
          elm_countFull.innerHTML = "作品全体：" + fullLength + "文字"
          elm_countFull.classList.add("loaded")
          elm_countFull.classList.remove("unloaded")
          writeText(mdParse(src.replace(/((.*\r?\n)*)(#+ 目次.*\r?\n)((.*\r?\n)*)((#|$)(.*(\r?\n)*)*)/gm, "$1" + toc + "$6")))
        }
      })
    }
  }
}
/*

  括弧を書き出す

*/
let arr_bracket = []
for (let i = 0; i < arr_bracketItself.length; i++) {
  arr_bracket.push(arr_bracketItself[i]["before"] + arr_bracketItself[i]["after"])
  if (i === arr_bracketItself.length - 1) {
    let bracketJoined = arr_bracket.join(", ")
    for (let j = 0; j < elmArr_bracket.length; j++) {
      elmArr_bracket[j].innerHTML = bracketJoined
    }
  }
}
/*

  オプション設定の処理

*/
elm_formatReading.onchange = () => {
  obj_search["format"] = "reading"
}
elm_formatPost.onchange = () => {
  obj_search["format"] = "post"
}
elm_formatPlot.onchange = () => {
  obj_search["format"] = "plot"
}
elm_formatPickup.onchange = () => {
  obj_search["format"] = "pickup"
}
elm_formatOdt.onchange = () => {
  obj_search["format"] = "odt"
}
elm_formatSelector.onchange = () => {
  obj_search["format"] = elm_formatSelector.options[elm_formatSelector.selectedIndex].value
  location.href = obj_url[currOrigin]["linkBase"] + arr_repoFile[1] + "&format=" + obj_search["format"] + "&orient=" + obj_search["orient"] + "&theme=" + obj_search["theme"] + "&mode=" +  obj_search["mode"]
}
elm_orientH.onchange = () => {
  obj_search["orient"] = "h"
  toggleOrient(obj_search["orient"])
}
elm_orientV.onchange = () => {
  obj_search["orient"] = "v"
  toggleOrient(obj_search["orient"])
}
elm_themeLight.onchange = () => {
  obj_search["theme"] = "light"
  toggleTheme(obj_search["theme"])
}
elm_themeDark.onchange = () => {
  obj_search["theme"] = "dark"
  toggleTheme(obj_search["theme"])
}
elm_modeNormal.onchange = () => {
  obj_search["mode"] = "nomal"
}
elm_modeHalf.onchange = () => {
  obj_search["mode"] = "half"
}
elm_modeChipNormal.onchange = () => {
  obj_search["mode"] = elm_modeChipNormal.value
  location.href = obj_url[currOrigin]["linkBase"] + arr_repoFile[1] + "&format=" + obj_search["format"] + "&orient=" + obj_search["orient"] + "&theme=" + obj_search["theme"] + "&mode=" +  obj_search["mode"]
}
elm_modeChipHalf.onchange = () => {
  obj_search["mode"] = elm_modeChipHalf.value
  location.href = obj_url[currOrigin]["linkBase"] + arr_repoFile[1] + "&format=" + obj_search["format"] + "&orient=" + obj_search["orient"] + "&theme=" + obj_search["theme"] + "&mode=" +  obj_search["mode"]
}
/*

  URL でオプションが指定されていた場合の処理

*/
// フォーマット
if (obj_search["format"] === "reading") {
  elm_formatReading.checked = true
  elm_formatSelector.options[0].selected = true
} else if (obj_search["format"] === "post") {
  elm_formatPost.checked = true
  elm_formatSelector.options[1].selected = true
} else if (obj_search["format"] === "plot") {
  elm_formatPlot.checked = true
  elm_formatSelector.options[2].selected = true
} else if (obj_search["format"] === "pickup") {
  elm_formatPickup.checked = true
  elm_formatSelector.options[3].selected = true
} else if (obj_search["format"] === "odt") {
  elm_formatOdt.checked = true
  elm_formatSelector.options[4].selected = true
}
// 書き方向
toggleOrient(obj_search["orient"])
if (obj_search["orient"] === "h") {
  elm_orientH.checked = true
} else if (obj_search["orient"] === "v") {
  elm_orientV.checked = true
}
// テーマ
toggleTheme(obj_search["theme"])
if (obj_search["theme"] === "light") {
  elm_themeLight.checked = true
} else if (obj_search["theme"] === "dark") {
  elm_themeDark.checked = true
}
// モード
if (obj_search["mode"] !== "half") {
  obj_search["mode"] = "normal"
  elm_modeNormal.checked = true
  elm_modeChipNormal.checked = true
} else {
  elm_modeHalf.checked = true
  elm_modeChipHalf.checked = true
}
/*

  URL で作品が指定されていた場合の処理

*/
if (obj_search["op"] !== undefined && arr_repoFile[1] !== "README.md") {
  loadContent(obj_url[currOrigin]["content"]).then(src => {
    exec(src)
    elm_formatChip.classList.remove("unloaded")
    elm_formatChip.classList.add("loaded")
    elm_modeChip.classList.remove("unloaded")
    elm_modeChip.classList.add("loaded")
  })
} else if (arr_repoFile[1] === "README.md") {
  obj_search["format"] = "plot"
  obj_search["mode"] = "c"
  loadContent(obj_url[currOrigin]["content"]).then(src => {
    if (src.match(/^# .*$/m)) {
      elm_title.innerHTML = src.replace(/^# (.*)\r?\n[\s\S]*/m, '$1')
    }
    obj_format["readme"](src)
  })
}
/*

  フォームからファイルが入力されたときの処理

*/
elm_input.onchange = () => {
  let fr = new FileReader()
  trgFile = input.files[0]
  fr.readAsText(trgFile)
  fr.addEventListener("load", function() {
    exec(fr.result)
  })
}
/*

  ドラッグ & ドロップされたときの処理

*/
window.addEventListener("dragover", function(e) {
  e.preventDefault()
  e.stopPropagation()
  let id = e.target.id
  e.dataTransfer.setData("id", id)
})
window.addEventListener("drop", function(e) {
  e.preventDefault()
  e.stopPropagation()
  let fr = new FileReader()
  trgFile = e.dataTransfer.files[0]
  fr.readAsText(trgFile)
  fr.addEventListener("load", function() {
    exec(fr.result)
  })
})
/*

  一気にスクロールする処理

*/
window.onkeyup = (e) => {
  if (e.key === "Enter") {
    let documentHeight = document.body.scrollHeight - document.body.clientHeight
    let currScroll = document.body.scrollTop
    if (currScroll === 0 || (currScroll >= documentHeight / 2 && currScroll !== documentHeight)) {
      document.body.scrollTo(0, documentHeight)
    } else if (currScroll === documentHeight || currScroll < documentHeight / 2) {
      document.body.scrollTo(0, 0)
    }
  }
}
/*

  文字列を選択したことで文字数を数えるときの処理

*/
window.addEventListener('mouseup', function(src) {
  countSelect(src)
})
window.addEventListener('touched', function(src) {
  countSelect(src)
})
/*

  リロード前のスクロールをリロード後に再現する

*/
window.onunload = () => {
  localStorage.setItem("scroll", document.body.scrollTop)
  localStorage.setItem("file", arr_repoFile[1])
}
window.onload = () => {
  if (localStorage.getItem("file") === arr_repoFile[1]) {
    document.body.scrollTop = localStorage.getItem("scroll")
  }
}
/*

  関数

*/
// キーになる処理
function exec(src) {
  let EOS_LF = src.match(/\n/)
  let EOS_CR = src.match(/\r\n/)
  if (EOS_LF === null || (EOS_LF !== null && EOS_CR !== null && EOS_LF.length < EOS_CR.length)) {
    EOS = "\r\n"
  }
  // 文章内のタイトル表記に使う変数 title に値を代入し、 <title> にタイトルを代入
  let arr_title = src.match(/^# .*/m)
  if (arr_title) {
    title = arr_title[0].replace(/# /, "")
    elm_title.textContent = title
  }
  // フォーマットどおりの処理
  obj_format[obj_search["format"]](src)
  // README.md を取得してきてリンクを設定する
  if(arr_repoFile[0] !== undefined) {
    loadContent(obj_url[currOrigin]["readme"]).then(m => {
      setLink(m)
    })
  }
  elm_text.classList.add("loaded")
}
// ファイルの読み込み
async function loadContent(url) {
  let now = new Date.now()
  let w = await fetch(url + "?" + now)
  return w.text()
}
// 変換の実処理
function titleAdd(src) {
  let titleHtml = ""
  if (title.length >= 1) {
    titleHtml = '<h1>' + title + '</h1>' + EOS
  }
  return titleHtml + src
}
function parseNewline(src) {
  return src.replace(/^(.*)$/gm, '<p>$1</p>')
            .replace(/<p><\/p>/g, '<p><br></p>')
}
function parseRuby(src) {
  return src.replace(/｜([^｜]*?)《(.*?)》/g, '<ruby>$1<rt>$2</rt></ruby>')
            .replace(/([\u4E00-\u9FFF]+)（(.*?)）/g, '<ruby>$1<rt>$2</rt></ruby>')
            .replace(/｜(（.*?）)/g, "$1")
}
function removeRuby(src) {
  return src.replace(/｜([^｜]*?)《.*?》/g, "$1")
            .replace(/([\u4E00-\u9FFF]+)（(.*?)）/g, "$1")
            .replace(/｜(（.*?）)/g, "$1")
}
function removeMd(src) {
  return src.replace(/^[ \t]*[#*+\-_~=`>|].*\r?\n/gm, "")
}
function parseOdt(src) {
  let w = src.replace(/^(?!<.*>)(.*)$/gm, '<text:p>$1</text:p>')
             .replace(/｜([^｜]*?)《(.*?)》/g, '<text:ruby><text:ruby-base>$1</text:ruby-base><text:ruby-text>$2</text:ruby-text></text:ruby>')
             .replace(/([\u4E00-\u9FFF]+)（(.*?)）/g, '<text:ruby><text:ruby-base>$1</text:ruby-base><text:ruby-text>$2</text:ruby-text></ text:ruby>')
             .replace(/｜(（.*?）)/g, "$1")
  let titleOdt = ""
  if (title.length >= 1) {
    titleOdt = '<text:p text:style-name="Title">' + title + '</text:p>\n'
    return (titleOdt + w).replace(/([\s\S]*)/m, obj_odt["content"]["start"] + "$1" + obj_odt["content"]["end"])
  } else {
    return w.replace(/([\s\S]*)/m, obj_odt["content"]["start"] + "$1" + obj_odt["content"]["end"])
  }
}
// 書き出しとその後の処理
function writeText(src) {
  elm_text.innerHTML = src
  elm_html.classList.remove("reading", "post", "plot", "pickup", "odt")
  elm_html.classList.add(obj_search["format"])
}
// タグを処理する type=0 消去、tyep=1 色づけ
function procBracket(src, type) {
  function RE_deleteItself() {
    let w = ""
    let h = 0
    for (let i = 0; i < arr_bracketItself.length; i++) {
      w += arr_bracketItself[i]["before"] + arr_bracketItself[i]["after"]
      h++
      if (h === arr_bracketItself.length) {
        return RegExp("[" + w + "]", "g")
      }
    }
  }
  function RE_deleteInclude() {
    let w = ""
    let h = 0
    for (let i = 0; i < arr_bracketInclude.length; i++) {
      w += arr_bracketInclude[i]["before"] + ".*?" + arr_bracketInclude[i]["after"] + "|"
      h++
      if (h === arr_bracketInclude.length) {
        return RegExp("(" + w + ")", "g")
      }
    }
  }
  let g = 0
  function markupItself(m) {
    let RE_bracketBefore = RegExp(arr_bracketItself[g]["before"], "g")
    let RE_bracketAfter = RegExp(arr_bracketItself[g]["after"], "g")
    let w = m.replace(RE_bracketBefore, arr_bracketItself[g]["replaceBefore"] + arr_bracketItself[g]["before"] + arr_bracketItself[g]["replaceAfter"]).replace(RE_bracketAfter, arr_bracketItself[g]["replaceBefore"] + arr_bracketItself[g]["after"] + arr_bracketItself[g]["replaceAfter"])
    g++
    if (g < arr_bracketItself.length) {
      markupItself(w)
    } else {
      return w
    }
  }
  let f = 0
  function markupInclude(m) {
    let RE_bracket = RegExp(arr_bracketInclude[f]["before"] + "(.*?)" + arr_bracketInclude[f]["after"], "g")
    let w = m.replace(RE_bracket, arr_bracketInclude[f]["replaceBefore"] + arr_bracketInclude[f]["before"] + "$1" + arr_bracketInclude[f]["after"] + arr_bracketInclude[f]["replaceAfter"])
    f++
    if (f < arr_bracketInclude.length) {
      markupInclude(w)
    } else {
      return w
    }
  }
  if (type === 1) {
    return markupInclude(markupItself(src))
  } else {
    return src.replace(RE_deleteItself(), "").replace(RE_deleteInclude(), "")
  }
}
// 全体の文字数を数える処理
function countFull(src) {
  elm_countFull.innerHTML = "全文：" + removeRuby(removeMd(src)).replace(/[\s　]/g, "").length + "文字"
  elm_countFull.classList.add("loaded")
  elm_countFull.classList.remove("unloaded")
}
// 選択範囲の文字数を数える処理
function countSelect(src) {
  setTimeout(() => {
    let selected = document.getSelection()
    if (selected.isCollapsed === false) {
      elm_countSelect.innerHTML = "選択：" + removeRuby(removeMd(selected.getRangeAt(0).toString())).replace(/[\s　]/g, "").length + "文字"
      elm_countSelect.classList.add("selected")
      elm_countSelect.classList.remove("unselected")
    } else {
      elm_countSelect.classList.add("unselected")
      elm_countSelect.classList.remove("selected")
    }
  }, 3)
}
// 前の・次の作品へのリンクを表示する
function setLink(src) {
  arr_toc = makeToc(src)
  let currrEEpisode = 0
  let obj_adjacentProc = {
    prev: function() {
      elm_prev.forEach(function(mediator) {
        mediator.href = obj_url[currOrigin]["prev"]
      })
      elm_prev.forEach(function(mediator) {
        mediator.innerHTML = "<< " + arr_toc[currEpisode - 1][1]
      })
    },
    next: function() {
      elm_next.forEach(function(mediator) {
        mediator.href = obj_url[currOrigin]["next"]
      })
      elm_next.forEach(function(mediator) {
        mediator.innerHTML = arr_toc[currEpisode + 1][1] + " >>"
      })
    }
  }
  let currEpisode = 0
  for (let i = 0; i < arr_toc.length; i++) {
    if (arr_toc[i][0] === arr_repoFile[1]) {
      currEpisode = i
    }
  }
  if (
    currEpisode !== 0
    &&
    currEpisode !== arr_toc.length - 1
  ) {
    obj_adjacentProc["prev"]()
    obj_adjacentProc["next"]()
  } else if (
    currEpisode !== 0
    &&
    arr_toc.length !== 1
  ) {
    obj_adjacentProc["prev"]()
  } else if (
    currEpisode === 0
    &&
    arr_toc.length >= 2
  ) {
    obj_adjacentProc["next"]()
  }
}
// 目次の作成
function makeToc(src) {
  return src.replace(/(.*\r?\n)*(#+ 目次.*\r?\n)((.*\r?\n)*)(#|$)/gm, "$3")
            .split(RegExp("\r?\n")).filter(w => w !== "")
            .map(w => w.replace(/^[*+-]? ?(.*)/g, "$1").split(RegExp(" ?: ?")))
}
// 書き方向の変更処理
function toggleOrient(orient) {
  elm_html.classList.remove("h", "v")
  elm_html.classList.add(orient)
}
// 色テーマの変更処理
function toggleTheme(theme) {
  elm_html.classList.remove("light", "dark" ,"auto")
  elm_html.classList.add(theme)
}
// odt が包含するファイルの中身
let obj_odt = {
  "content": {
    "start": `<?xml version="1.0" encoding="UTF-8"?>
<office:document-content xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:fo="urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0" xmlns:ooo="http://openoffice.org/2004/office" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:style="urn:oasis:names:tc:opendocument:xmlns:style:1.0" xmlns:text="urn:oasis:names:tc:opendocument:xmlns:text:1.0" xmlns:draw="urn:oasis:names:tc:opendocument:xmlns:drawing:1.0" xmlns:dr3d="urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0" xmlns:svg="urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0" xmlns:chart="urn:oasis:names:tc:opendocument:xmlns:chart:1.0" xmlns:rpt="http://openoffice.org/2005/report" xmlns:table="urn:oasis:names:tc:opendocument:xmlns:table:1.0" xmlns:number="urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0" xmlns:ooow="http://openoffice.org/2004/writer" xmlns:oooc="http://openoffice.org/2004/calc" xmlns:of="urn:oasis:names:tc:opendocument:xmlns:of:1.2" xmlns:tableooo="http://openoffice.org/2009/table" xmlns:calcext="urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0" xmlns:drawooo="http://openoffice.org/2010/draw" xmlns:loext="urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0" xmlns:field="urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0" xmlns:math="http://www.w3.org/1998/Math/MathML" xmlns:form="urn:oasis:names:tc:opendocument:xmlns:form:1.0" xmlns:script="urn:oasis:names:tc:opendocument:xmlns:script:1.0" xmlns:dom="http://www.w3.org/2001/xml-events" xmlns:xforms="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:formx="urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:grddl="http://www.w3.org/2003/g/data-view#" xmlns:css3t="http://www.w3.org/TR/css3-text/" xmlns:officeooo="http://openoffice.org/2009/office" office:version="1.3"><office:scripts/><office:font-face-decls><style:font-face style:name="Arial1" svg:font-family="Arial" style:font-family-generic="swiss"/><style:font-face style:name="Liberation Serif" svg:font-family="&apos;Liberation Serif&apos;" style:font-family-generic="roman" style:font-pitch="variable"/><style:font-face style:name="Liberation Sans" svg:font-family="&apos;Liberation Sans&apos;" style:font-family-generic="swiss" style:font-pitch="variable"/><style:font-face style:name="Arial" svg:font-family="Arial" style:font-family-generic="system" style:font-pitch="variable"/><style:font-face style:name="游ゴシック" svg:font-family="游ゴシック" style:font-family-generic="system" style:font-pitch="variable"/><style:font-face style:name="游明朝" svg:font-family="游明朝" style:font-family-generic="system" style:font-pitch="variable"/></office:font-face-decls><office:automatic-styles><style:style style:name="Ru1" style:family="ruby"><style:ruby-properties style:ruby-align="left" style:ruby-position="above" loext:ruby-position="above"/></style:style></office:automatic-styles><office:body><office:text><text:sequence-decls><text:sequence-decl text:display-outline-level="0" text:name="Illustration"/><text:sequence-decl text:display-outline-level="0" text:name="Table"/><text:sequence-decl text:display-outline-level="0" text:name="Text"/><text:sequence-decl text:display-outline-level="0" text:name="Drawing"/><text:sequence-decl text:display-outline-level="0" text:name="Figure"/></text:sequence-decls>`,
    "end" : '</office:text></office:body></office:document-content>'
  },
  "files": [
    ["manifest.rdf", "/", `<?xml version="1.0" encoding="utf-8"?>
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
  <rdf:Description rdf:about="styles.xml">
    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/odf#StylesFile"/>
  </rdf:Description>
  <rdf:Description rdf:about="">
    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="styles.xml"/>
  </rdf:Description>
  <rdf:Description rdf:about="content.xml">
    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/odf#ContentFile"/>
  </rdf:Description>
  <rdf:Description rdf:about="">
    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="content.xml"/>
  </rdf:Description>
  <rdf:Description rdf:about="">
    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#Document"/>
  </rdf:Description>
</rdf:RDF>`],
    ["manifest.xml", "META-INF", `<?xml version="1.0" encoding="UTF-8"?>
<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.3" xmlns:loext="urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0">
 <manifest:file-entry manifest:full-path="/" manifest:version="1.3" manifest:media-type="application/vnd.oasis.opendocument.text"/>
 <manifest:file-entry manifest:full-path="Configurations2/" manifest:media-type="application/vnd.sun.xml.ui.configuration"/>
 <manifest:file-entry manifest:full-path="manifest.rdf" manifest:media-type="application/rdf+xml"/>
 <manifest:file-entry manifest:full-path="styles.xml" manifest:media-type="text/xml"/>
 <manifest:file-entry manifest:full-path="meta.xml" manifest:media-type="text/xml"/>
 <manifest:file-entry manifest:full-path="settings.xml" manifest:media-type="text/xml"/>
 <manifest:file-entry manifest:full-path="content.xml" manifest:media-type="text/xml"/>
 <manifest:file-entry manifest:full-path="Thumbnails/thumbnail.png" manifest:media-type="image/png"/>
</manifest:manifest>`],
    ["meta.xml", "/", `<?xml version="1.0" encoding="UTF-8"?>
<office:document-meta xmlns:grddl="http://www.w3.org/2003/g/data-view#" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:ooo="http://openoffice.org/2004/office" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:dc="http://purl.org/dc/elements/1.1/" office:version="1.3"><office:meta><meta:creation-date>2021-09-08T09:36:03.123000000</meta:creation-date><meta:generator>LibreOffice/7.1.5.2$Windows_X86_64 LibreOffice_project/85f04e9f809797b8199d13c421bd8a2b025d52b5</meta:generator><dc:date>2021-09-08T14:45:22.466000000</dc:date><meta:editing-duration>PT1M16S</meta:editing-duration><meta:editing-cycles>2</meta:editing-cycles><meta:document-statistic meta:table-count="0" meta:image-count="0" obj_meta:ect-count="0" meta:page-count="1" meta:paragraph-count="1" meta:word-count="15" meta:character-count="15" meta:non-whitespace-character-count="15"/></office:meta></office:document-meta>`],
    ["mimetype", "/", `application/vnd.oasis.opendocument.text`],
    ["settings.xml", "/", `<?xml version="1.0" encoding="UTF-8"?>
<office:document-settings xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:ooo="http://openoffice.org/2004/office" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:config="urn:oasis:names:tc:opendocument:xmlns:config:1.0" office:version="1.3"><office:settings><config:config-item-set config:name="ooo:view-settings"><config:config-item config:name="ViewAreaTop" config:type="long">0</config:config-item><config:config-item config:name="ViewAreaLeft" config:type="long">0</config:config-item><config:config-item config:name="ViewAreaWidth" config:type="long">36356</config:config-item><config:config-item config:name="ViewAreaHeight" config:type="long">18496</config:config-item><config:config-item config:name="ShowRedlineChanges" config:type="boolean">true</config:config-item><config:config-item config:name="InBrowseMode" config:type="boolean">false</config:config-item><config:config-item-map-indexed config:name="Views"><config:config-item-map-entry><config:config-item config:name="ViewId" config:type="string">view2</config:config-item><config:config-item config:name="ViewLeft" config:type="long">9677</config:config-item><config:config-item config:name="ViewTop" config:type="long">2501</config:config-item><config:config-item config:name="VisibleLeft" config:type="long">0</config:config-item><config:config-item config:name="VisibleTop" config:type="long">0</config:config-item><config:config-item config:name="VisibleRight" config:type="long">36354</config:config-item><config:config-item config:name="VisibleBottom" config:type="long">18494</config:config-item><config:config-item config:name="ZoomType" config:type="short">0</config:config-item><config:config-item config:name="ViewLayoutColumns" config:type="short">1</config:config-item><config:config-item config:name="ViewLayoutBookMode" config:type="boolean">false</config:config-item><config:config-item config:name="ZoomFactor" config:type="short">100</config:config-item><config:config-item config:name="IsSelectedFrame" config:type="boolean">false</config:config-item><config:config-item config:name="AnchoredTextOverflowLegacy" config:type="boolean">false</config:config-item></config:config-item-map-entry></config:config-item-map-indexed></config:config-item-set><config:config-item-set config:name="ooo:configuration-settings"><config:config-item config:name="ProtectForm" config:type="boolean">false</config:config-item><config:config-item config:name="PrinterName" config:type="string"/><config:config-item config:name="EmbeddedDatabaseName" config:type="string"/><config:config-item config:name="CurrentDatabaseDataSource" config:type="string"/><config:config-item config:name="LinkUpdateMode" config:type="short">1</config:config-item><config:config-item config:name="AddParaTableSpacingAtStart" config:type="boolean">true</config:config-item><config:config-item config:name="FloattableNomargins" config:type="boolean">false</config:config-item><config:config-item config:name="UnbreakableNumberings" config:type="boolean">false</config:config-item><config:config-item config:name="FieldAutoUpdate" config:type="boolean">true</config:config-item><config:config-item config:name="AddVerticalFrameOffsets" config:type="boolean">false</config:config-item><config:config-item config:name="BackgroundParaOverDrawings" config:type="boolean">false</config:config-item><config:config-item config:name="AddParaTableSpacing" config:type="boolean">true</config:config-item><config:config-item config:name="ChartAutoUpdate" config:type="boolean">true</config:config-item><config:config-item config:name="CurrentDatabaseCommand" config:type="string"/><config:config-item config:name="PrinterSetup" config:type="base64Binary"/><config:config-item config:name="AlignTabStopPosition" config:type="boolean">true</config:config-item><config:config-item config:name="PrinterPaperFromSetup" config:type="boolean">false</config:config-item><config:config-item config:name="IsKernAsianPunctuation" config:type="boolean">false</config:config-item><config:config-item config:name="CharacterCompressionType" config:type="short">0</config:config-item><config:config-item config:name="ApplyUserData" config:type="boolean">true</config:config-item><config:config-item config:name="DoNotJustifyLinesWithManualBreak" config:type="boolean">true</config:config-item><config:config-item config:name="SaveThumbnail" config:type="boolean">true</config:config-item><config:config-item config:name="SaveGlobalDocumentLinks" config:type="boolean">false</config:config-item><config:config-item config:name="SmallCapsPercentage66" config:type="boolean">false</config:config-item><config:config-item config:name="CurrentDatabaseCommandType" config:type="int">0</config:config-item><config:config-item config:name="SaveVersionOnClose" config:type="boolean">false</config:config-item><config:config-item config:name="UpdateFromTemplate" config:type="boolean">true</config:config-item><config:config-item obj_config:name="DoNotCaptureDrawsOnPage" config:type="boolean">false</config:config-item><config:config-item obj_config:name="UseFormerectPositioning" config:type="boolean">false</config:config-item><config:config-item config:name="PrintSingleJobs" config:type="boolean">false</config:config-item><config:config-item config:name="EmbedSystemFonts" config:type="boolean">false</config:config-item><config:config-item config:name="PrinterIndependentLayout" config:type="string">high-resolution</config:config-item><config:config-item config:name="IsLabelDocument" config:type="boolean">false</config:config-item><config:config-item config:name="AddFrameOffsets" config:type="boolean">false</config:config-item><config:config-item config:name="AddExternalLeading" config:type="boolean">true</config:config-item><config:config-item config:name="MsWordCompMinLineHeightByFly" config:type="boolean">false</config:config-item><config:config-item config:name="UseOldNumbering" config:type="boolean">false</config:config-item><config:config-item config:name="OutlineLevelYieldsNumbering" config:type="boolean">false</config:config-item><config:config-item config:name="DoNotResetParaAttrsForNumFont" config:type="boolean">false</config:config-item><config:config-item config:name="IgnoreFirstLineIndentInNumbering" config:type="boolean">false</config:config-item><config:config-item config:name="AllowPrintJobCancel" config:type="boolean">true</config:config-item><config:config-item config:name="UseFormerLineSpacing" config:type="boolean">false</config:config-item><config:config-item config:name="AddParaSpacingToTableCells" config:type="boolean">true</config:config-item><config:config-item config:name="AddParaLineSpacingToTableCells" config:type="boolean">true</config:config-item><config:config-item config:name="UseFormerTextWrapping" config:type="boolean">false</config:config-item><config:config-item config:name="RedlineProtectionKey" config:type="base64Binary"/><config:config-item obj_config:name="ConsiderTextWrapOnPos" config:type="boolean">false</config:config-item><config:config-item config:name="TableRowKeep" config:type="boolean">false</config:config-item><config:config-item config:name="TabsRelativeToIndent" config:type="boolean">true</config:config-item><config:config-item config:name="IgnoreTabsAndBlanksForLineCalculation" config:type="boolean">false</config:config-item><config:config-item config:name="RsidRoot" config:type="int">312482</config:config-item><config:config-item config:name="LoadReadonly" config:type="boolean">false</config:config-item><config:config-item config:name="ClipAsCharacterAnchoredWriterFlyFrames" config:type="boolean">false</config:config-item><config:config-item config:name="UnxForceZeroExtLeading" config:type="boolean">false</config:config-item><config:config-item config:name="UseOldPrinterMetrics" config:type="boolean">false</config:config-item><config:config-item config:name="TabAtLeftIndentForParagraphsInList" config:type="boolean">false</config:config-item><config:config-item config:name="Rsid" config:type="int">522415</config:config-item><config:config-item config:name="MsWordCompTrailingBlanks" config:type="boolean">false</config:config-item><config:config-item config:name="MathBaselineAlignment" config:type="boolean">true</config:config-item><config:config-item config:name="InvertBorderSpacing" config:type="boolean">false</config:config-item><config:config-item config:name="CollapseEmptyCellPara" config:type="boolean">true</config:config-item><config:config-item config:name="TabOverflow" config:type="boolean">true</config:config-item><config:config-item config:name="StylesNoDefault" config:type="boolean">false</config:config-item><config:config-item config:name="ClippedPictures" config:type="boolean">false</config:config-item><config:config-item config:name="EmbedFonts" config:type="boolean">false</config:config-item><config:config-item config:name="EmbedOnlyUsedFonts" config:type="boolean">false</config:config-item><config:config-item config:name="EmbedLatinScriptFonts" config:type="boolean">true</config:config-item><config:config-item config:name="EmbedAsianScriptFonts" config:type="boolean">true</config:config-item><config:config-item config:name="EmptyDbFieldHidesPara" config:type="boolean">true</config:config-item><config:config-item config:name="EmbedComplexScriptFonts" config:type="boolean">true</config:config-item><config:config-item config:name="TabOverMargin" config:type="boolean">false</config:config-item><config:config-item config:name="TreatSingleColumnBreakAsPageBreak" config:type="boolean">false</config:config-item><config:config-item config:name="SurroundTextWrapSmall" config:type="boolean">false</config:config-item><config:config-item config:name="ApplyParagraphMarkFormatToNumbering" config:type="boolean">false</config:config-item><config:config-item config:name="PropLineSpacingShrinksFirstLine" config:type="boolean">true</config:config-item><config:config-item config:name="SubtractFlysAnchoredAtFlys" config:type="boolean">false</config:config-item><config:config-item config:name="DisableOffPagePositioning" config:type="boolean">false</config:config-item><config:config-item config:name="ContinuousEndnotes" config:type="boolean">false</config:config-item><config:config-item config:name="ProtectBookmarks" config:type="boolean">false</config:config-item><config:config-item config:name="ProtectFields" config:type="boolean">false</config:config-item><config:config-item config:name="HeaderSpacingBelowLastPara" config:type="boolean">false</config:config-item><config:config-item config:name="FrameAutowidthWithMorePara" config:type="boolean">false</config:config-item><config:config-item config:name="PrintAnnotationMode" config:type="short">0</config:config-item><config:config-item config:name="PrintGraphics" config:type="boolean">true</config:config-item><config:config-item config:name="PrintBlackFonts" config:type="boolean">false</config:config-item><config:config-item config:name="PrintLeftPages" config:type="boolean">true</config:config-item><config:config-item config:name="PrintControls" config:type="boolean">true</config:config-item><config:config-item config:name="PrintPageBackground" config:type="boolean">true</config:config-item><config:config-item config:name="PrintTextPlaceholder" config:type="boolean">false</config:config-item><config:config-item config:name="PrintDrawings" config:type="boolean">true</config:config-item><config:config-item config:name="PrintHiddenText" config:type="boolean">false</config:config-item><config:config-item config:name="PrintProspect" config:type="boolean">false</config:config-item><config:config-item config:name="PrintTables" config:type="boolean">true</config:config-item><config:config-item config:name="PrintProspectRTL" config:type="boolean">false</config:config-item><config:config-item config:name="PrintReversed" config:type="boolean">false</config:config-item><config:config-item config:name="PrintRightPages" config:type="boolean">true</config:config-item><config:config-item config:name="PrintFaxName" config:type="string"/><config:config-item config:name="PrintPaperFromSetup" config:type="boolean">false</config:config-item><config:config-item config:name="PrintEmptyPages" config:type="boolean">true</config:config-item></config:config-item-set></office:settings></office:document-settings>`],
    ["styles.xml", "/", `<?xml version="1.0" encoding="UTF-8"?>
<office:document-styles xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:fo="urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0" xmlns:ooo="http://openoffice.org/2004/office" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:style="urn:oasis:names:tc:opendocument:xmlns:style:1.0" xmlns:text="urn:oasis:names:tc:opendocument:xmlns:text:1.0" xmlns:draw="urn:oasis:names:tc:opendocument:xmlns:drawing:1.0" xmlns:dr3d="urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0" xmlns:svg="urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0" xmlns:chart="urn:oasis:names:tc:opendocument:xmlns:chart:1.0" xmlns:rpt="http://openoffice.org/2005/report" xmlns:table="urn:oasis:names:tc:opendocument:xmlns:table:1.0" xmlns:number="urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0" xmlns:ooow="http://openoffice.org/2004/writer" xmlns:oooc="http://openoffice.org/2004/calc" xmlns:of="urn:oasis:names:tc:opendocument:xmlns:of:1.2" xmlns:tableooo="http://openoffice.org/2009/table" xmlns:calcext="urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0" xmlns:drawooo="http://openoffice.org/2010/draw" xmlns:loext="urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0" xmlns:field="urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0" xmlns:math="http://www.w3.org/1998/Math/MathML" xmlns:form="urn:oasis:names:tc:opendocument:xmlns:form:1.0" xmlns:script="urn:oasis:names:tc:opendocument:xmlns:script:1.0" xmlns:dom="http://www.w3.org/2001/xml-events" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:grddl="http://www.w3.org/2003/g/data-view#" xmlns:css3t="http://www.w3.org/TR/css3-text/" xmlns:officeooo="http://openoffice.org/2009/office" office:version="1.3"><office:font-face-decls><style:font-face style:name="Arial1" svg:font-family="Arial" style:font-family-generic="swiss"/><style:font-face style:name="Liberation Serif" svg:font-family="&apos;Liberation Serif&apos;" style:font-family-generic="roman" style:font-pitch="variable"/><style:font-face style:name="Liberation Sans" svg:font-family="&apos;Liberation Sans&apos;" style:font-family-generic="swiss" style:font-pitch="variable"/><style:font-face style:name="Arial" svg:font-family="Arial" style:font-family-generic="system" style:font-pitch="variable"/><style:font-face style:name="游ゴシック" svg:font-family="游ゴシック" style:font-family-generic="system" style:font-pitch="variable"/><style:font-face style:name="游明朝" svg:font-family="游明朝" style:font-family-generic="system" style:font-pitch="variable"/></office:font-face-decls><office:styles><style:default-style style:family="graphic"><style:graphic-properties svg:stroke-color="#3465a4" draw:fill-color="#729fcf" fo:wrap-option="no-wrap" draw:shadow-offset-x="0.3cm" draw:shadow-offset-y="0.3cm" draw:start-line-spacing-horizontal="0.283cm" draw:start-line-spacing-vertical="0.283cm" draw:end-line-spacing-horizontal="0.283cm" draw:end-line-spacing-vertical="0.283cm" style:flow-with-text="false"/><style:paragraph-properties style:text-autospace="ideograph-alpha" style:line-break="strict" style:font-independent-line-spacing="false"><style:tab-stops/></style:paragraph-properties><style:text-properties style:use-window-font-color="true" loext:opacity="0%" style:font-name="Liberation Serif" fo:font-size="12pt" fo:language="en" fo:country="US" style:letter-kerning="true" style:font-name-asian="游明朝" style:font-size-asian="10.5pt" style:language-asian="ja" style:country-asian="JP" style:font-name-complex="Arial" style:font-size-complex="12pt" style:language-complex="hi" style:country-complex="IN"/></style:default-style><style:default-style style:family="paragraph"><style:paragraph-properties fo:orphans="2" fo:widows="2" fo:hyphenation-ladder-count="no-limit" style:text-autospace="ideograph-alpha" style:punctuation-wrap="hanging" style:line-break="strict" style:tab-stop-distance="1.251cm" style:writing-mode="page"/><style:text-properties style:use-window-font-color="true" loext:opacity="0%" style:font-name="Liberation Serif" fo:font-size="12pt" fo:language="en" fo:country="US" style:letter-kerning="true" style:font-name-asian="游明朝" style:font-size-asian="10.5pt" style:language-asian="ja" style:country-asian="JP" style:font-name-complex="Arial" style:font-size-complex="12pt" style:language-complex="hi" style:country-complex="IN" fo:hyphenate="false" fo:hyphenation-remain-char-count="2" fo:hyphenation-push-char-count="2" loext:hyphenation-no-caps="false"/></style:default-style><style:default-style style:family="table"><style:table-properties table:border-model="collapsing"/></style:default-style><style:default-style style:family="table-row"><style:table-row-properties fo:keep-together="auto"/></style:default-style><style:style style:name="Standard" style:family="paragraph" style:class="text"/><style:style style:name="Heading" style:family="paragraph" style:parent-style-name="Standard" style:next-style-name="Text_20_body" style:class="text"><style:paragraph-properties fo:margin-top="0.423cm" fo:margin-bottom="0.212cm" style:contextual-spacing="false" fo:keep-with-next="always"/><style:text-properties style:font-name="Liberation Sans" fo:font-family="&apos;Liberation Sans&apos;" style:font-family-generic="swiss" style:font-pitch="variable" fo:font-size="14pt" style:font-name-asian="游ゴシック" style:font-family-asian="游ゴシック" style:font-family-generic-asian="system" style:font-pitch-asian="variable" style:font-size-asian="14pt" style:font-name-complex="Arial" style:font-family-complex="Arial" style:font-family-generic-complex="system" style:font-pitch-complex="variable" style:font-size-complex="14pt"/></style:style><style:style style:name="Text_20_body" style:display-name="Text body" style:family="paragraph" style:parent-style-name="Standard" style:class="text"><style:paragraph-properties fo:margin-top="0cm" fo:margin-bottom="0.247cm" style:contextual-spacing="false" fo:line-height="115%"/></style:style><style:style style:name="List" style:family="paragraph" style:parent-style-name="Text_20_body" style:class="list"><style:text-properties style:font-size-asian="12pt" style:font-name-complex="Arial1" style:font-family-complex="Arial" style:font-family-generic-complex="swiss"/></style:style><style:style style:name="Caption" style:family="paragraph" style:parent-style-name="Standard" style:class="extra"><style:paragraph-properties fo:margin-top="0.212cm" fo:margin-bottom="0.212cm" style:contextual-spacing="false" text:number-lines="false" text:line-number="0"/><style:text-properties fo:font-size="12pt" fo:font-style="italic" style:font-size-asian="12pt" style:font-style-asian="italic" style:font-name-complex="Arial1" style:font-family-complex="Arial" style:font-family-generic-complex="swiss" style:font-size-complex="12pt" style:font-style-complex="italic"/></style:style><style:style style:name="Index" style:family="paragraph" style:parent-style-name="Standard" style:class="index"><style:paragraph-properties text:number-lines="false" text:line-number="0"/><style:text-properties style:font-size-asian="12pt" style:font-name-complex="Arial1" style:font-family-complex="Arial" style:font-family-generic-complex="swiss"/></style:style><style:style style:name="Rubies" style:family="text"><style:text-properties fo:font-size="6pt" style:text-underline-style="none" style:font-size-asian="6pt" style:font-size-complex="6pt" style:text-emphasize="none"/></style:style><text:outline-style style:name="Outline"><text:outline-level-style text:level="1" style:num-format=""><style:list-level-properties text:list-level-position-and-space-mode="label-alignment"><style:list-level-label-alignment text:label-followed-by="listtab"/></style:list-level-properties></text:outline-level-style><text:outline-level-style text:level="2" style:num-format=""><style:list-level-properties text:list-level-position-and-space-mode="label-alignment"><style:list-level-label-alignment text:label-followed-by="listtab"/></style:list-level-properties></text:outline-level-style><text:outline-level-style text:level="3" style:num-format=""><style:list-level-properties text:list-level-position-and-space-mode="label-alignment"><style:list-level-label-alignment text:label-followed-by="listtab"/></style:list-level-properties></text:outline-level-style><text:outline-level-style text:level="4" style:num-format=""><style:list-level-properties text:list-level-position-and-space-mode="label-alignment"><style:list-level-label-alignment text:label-followed-by="listtab"/></style:list-level-properties></text:outline-level-style><text:outline-level-style text:level="5" style:num-format=""><style:list-level-properties text:list-level-position-and-space-mode="label-alignment"><style:list-level-label-alignment text:label-followed-by="listtab"/></style:list-level-properties></text:outline-level-style><text:outline-level-style text:level="6" style:num-format=""><style:list-level-properties text:list-level-position-and-space-mode="label-alignment"><style:list-level-label-alignment text:label-followed-by="listtab"/></style:list-level-properties></text:outline-level-style><text:outline-level-style text:level="7" style:num-format=""><style:list-level-properties text:list-level-position-and-space-mode="label-alignment"><style:list-level-label-alignment text:label-followed-by="listtab"/></style:list-level-properties></text:outline-level-style><text:outline-level-style text:level="8" style:num-format=""><style:list-level-properties text:list-level-position-and-space-mode="label-alignment"><style:list-level-label-alignment text:label-followed-by="listtab"/></style:list-level-properties></text:outline-level-style><text:outline-level-style text:level="9" style:num-format=""><style:list-level-properties text:list-level-position-and-space-mode="label-alignment"><style:list-level-label-alignment text:label-followed-by="listtab"/></style:list-level-properties></text:outline-level-style><text:outline-level-style text:level="10" style:num-format=""><style:list-level-properties text:list-level-position-and-space-mode="label-alignment"><style:list-level-label-alignment text:label-followed-by="listtab"/></style:list-level-properties></text:outline-level-style></text:outline-style><text:notes-configuration text:note-class="footnote" style:num-format="1" text:start-value="0" text:footnotes-position="page" text:start-numbering-at="document"/><text:notes-configuration text:note-class="endnote" style:num-format="i" text:start-value="0"/><text:linenumbering-configuration text:number-lines="false" text:offset="0.499cm" style:num-format="1" text:number-position="left" text:increment="5"/></office:styles><office:automatic-styles><style:page-layout style:name="Mpm1"><style:page-layout-properties fo:page-width="21.001cm" fo:page-height="29.7cm" style:num-format="1" style:print-orientation="portrait" fo:margin-top="2cm" fo:margin-bottom="2cm" fo:margin-left="2cm" fo:margin-right="2cm" style:writing-mode="lr-tb" style:layout-grid-color="#c0c0c0" style:layout-grid-lines="20" style:layout-grid-base-height="0.706cm" style:layout-grid-ruby-height="0.353cm" style:layout-grid-mode="none" style:layout-grid-ruby-below="false" style:layout-grid-print="false" style:layout-grid-display="false" style:footnote-max-height="0cm"><style:footnote-sep style:width="0.018cm" style:distance-before-sep="0.101cm" style:distance-after-sep="0.101cm" style:line-style="solid" style:adjustment="left" style:rel-width="25%" style:color="#000000"/></style:page-layout-properties><style:header-style/><style:footer-style/></style:page-layout></office:automatic-styles><office:master-styles><style:master-page style:name="Standard" style:page-layout-name="Mpm1"/></office:master-styles></office:document-styles>`]
  ]
}
</script>
</html>
